<h2>{{ sheetName }}</h2>

@if (columns.length === 0) {

<p>No columns found</p>

} @if (rows.length === 0) {

<p>No rows found</p>

}

<table>
  @if ((headerVM?.length ?? 0) > 0) {

  <thead>
    @for (row of headerVM; track $index) {
    <tr>
      @for (cell of row; track $index) { @if (!cell.hidden) {
      <th [attr.colspan]="cell.colspan" [attr.rowspan]="cell.rowspan">
        {{ cell.text }}
      </th>
      } }
    </tr>
    }
  </thead>

  }

  <tbody>
    @for (row of sampleRows; track $index) {
    <tr>
      <!-- First column: merge with rowspan -->
      @if (bodyMergeKey) { @let meta = bodyMergeMeta[$index]; @if
      (!meta?.hidden) {
      <td [attr.rowspan]="meta?.rowspan ?? 1">
        {{ row[bodyMergeKey] }}
      </td>
      } }

      <!-- Other columns (skip the merged one) -->
      @for (col of columns; track $index) { @if (col !== bodyMergeKey) {
      <td>{{ row[col] }}</td>
      } }
    </tr>
    }
  </tbody>
</table>
